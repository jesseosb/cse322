<!DOCTYPE html>
<html>

<head>
  <title>Update Beers</title>
  <link rel="stylesheet" href="/gerrards/beerstyle.css">
  <meta charset="utf-8">
</head>

<body>


<script type="text/javascript">
var xmlhttp;
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
     xmlhttp=new XMLHttpRequest();
} else {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
if ( xmlhttp != null ) 
{ 
    xmlhttp.open("GET","3kbeers.txt",false); // false makes this synchronous! SJAX?
    xmlhttp.send( );
    var text = xmlhttp.responseText; // contains the contents of the .txt file 
    
    // but you might want to process that one line at a time.  if so:
    var lines = text.split( "\n" );
    window.onload = function(evt) {
      document.getElementById('ajaxTextbox').value = lines.join('\n');
      // document.getElementById('button2').innerHTML = lines.join('<br>');
    };
    for ( var n = 0; n < lines.length; ++n )
    {
        var line = lines[n].split( "," );
        // document.getElementById("ajaxTextbox").value = line;
        // and now you can do whatever is needed with that line
    }
}
</script>

  <div id="button">
    <p>
      <textarea id="ajaxTextbox" cols=80 rows=40></textarea>
    </p>
    <span id="ajaxButton" style="cursor: pointer; text-decoration: underline">
    Transform
    </span>
    <script type="text/javascript">
      (function() {
        var httpRequest;
        document.getElementById("ajaxButton").onclick = function() {
          var beerList = document.getElementById("ajaxTextbox").value;
          makeRequest('beers.php', beerList);
        };

        function makeRequest(url, beerList) {
          httpRequest = new XMLHttpRequest();

          if (!httpRequest) {
            alert('Giving up :( Cannot create an XMLHTTP instance');
            return false;
          }
          httpRequest.onreadystatechange = alertContents;
          httpRequest.open('POST', url);
          httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
          httpRequest.send('beerList=' + encodeURIComponent(beerList));
        }

        function alertContents() {
          if (httpRequest.readyState === XMLHttpRequest.DONE) {
            if (httpRequest.status === 200) {
              // response = JSON.parse(httpRequest.responseText);
              alert("Updated beersList.txt");
            }
            else {
              alert('There was a problem with the request.');
            }
          }
        }
      })();
    </script>
  </div>
</body>

</html>